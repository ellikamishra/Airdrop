{"ast":null,"code":"\"use strict\";\n\nvar _regeneratorRuntime = require(\"/home/ellika/Web3/node_modules/@babel/runtime/regenerator/index.js\");\n\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nvar __rest = this && this.__rest || function (s, e) {\n  var t = {};\n\n  for (var p in s) {\n    if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n  }\n\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.call = exports.getChainId = exports.setChainIdOverride = exports.signData = exports.send = void 0;\n\nvar randomId = function randomId() {\n  return Math.floor(Math.random() * 10000000000);\n};\n\nexports.send = function (provider, method, params) {\n  return new Promise(function (resolve, reject) {\n    var _a;\n\n    var payload = {\n      id: randomId(),\n      method: method,\n      params: params\n    };\n\n    var callback = function callback(err, result) {\n      if (err) {\n        reject(err);\n      } else if (result.error) {\n        console.error(result.error);\n        reject(result.error);\n      } else {\n        resolve(result.result);\n      }\n    };\n\n    var _provider = ((_a = provider.provider) === null || _a === void 0 ? void 0 : _a.provider) || provider.provider || provider;\n\n    if (_provider.getUncheckedSigner\n    /* ethers provider */\n    ) {\n      _provider.send(method, params).then(function (r) {\n        return resolve(r);\n      }).catch(function (e) {\n        return reject(e);\n      });\n    } else if (_provider.sendAsync) {\n      _provider.sendAsync(payload, callback);\n    } else {\n      _provider.send(payload, callback).catch(function (error) {\n        if (error.message === \"Hardhat Network doesn't support JSON-RPC params sent as an object\") {\n          _provider.send(method, params).then(function (r) {\n            return resolve(r);\n          }).catch(function (e) {\n            return reject(e);\n          });\n        } else {\n          throw error;\n        }\n      });\n    }\n  });\n};\n\nvar splitSignatureToRSV = function splitSignatureToRSV(signature) {\n  var r = '0x' + signature.substring(2).substring(0, 64);\n  var s = '0x' + signature.substring(2).substring(64, 128);\n  var v = parseInt(signature.substring(2).substring(128, 130), 16);\n  return {\n    r: r,\n    s: s,\n    v: v\n  };\n};\n\nvar signWithEthers = function signWithEthers(signer, fromAddress, typeData) {\n  return __awaiter(void 0, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n    var signerAddress, _a, _unused, types, rawSignature;\n\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.next = 2;\n            return signer.getAddress();\n\n          case 2:\n            signerAddress = _context.sent;\n\n            if (!(signerAddress.toLowerCase() !== fromAddress.toLowerCase())) {\n              _context.next = 5;\n              break;\n            }\n\n            throw new Error('Signer address does not match requested signing address');\n\n          case 5:\n            _a = typeData.types, _unused = _a.EIP712Domain, types = __rest(_a, [\"EIP712Domain\"]);\n            _context.next = 8;\n            return signer.signTypedData ? signer.signTypedData(typeData.domain, types, typeData.message) : signer._signTypedData(typeData.domain, types, typeData.message);\n\n          case 8:\n            rawSignature = _context.sent;\n            return _context.abrupt(\"return\", splitSignatureToRSV(rawSignature));\n\n          case 10:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n};\n\nexports.signData = function (provider, fromAddress, typeData) {\n  return __awaiter(void 0, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n    var typeDataString, result;\n    return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            if (!(provider._signTypedData || provider.signTypedData)) {\n              _context2.next = 2;\n              break;\n            }\n\n            return _context2.abrupt(\"return\", signWithEthers(provider, fromAddress, typeData));\n\n          case 2:\n            typeDataString = typeof typeData === 'string' ? typeData : JSON.stringify(typeData);\n            _context2.next = 5;\n            return exports.send(provider, 'eth_signTypedData_v4', [fromAddress, typeDataString]).catch(function (error) {\n              if (error.message === 'Method eth_signTypedData_v4 not supported.') {\n                return exports.send(provider, 'eth_signTypedData', [fromAddress, typeData]);\n              } else {\n                throw error;\n              }\n            });\n\n          case 5:\n            result = _context2.sent;\n            return _context2.abrupt(\"return\", {\n              r: result.slice(0, 66),\n              s: '0x' + result.slice(66, 130),\n              v: parseInt(result.slice(130, 132), 16)\n            });\n\n          case 7:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2);\n  }));\n};\n\nvar chainIdOverride = null;\n\nexports.setChainIdOverride = function (id) {\n  chainIdOverride = id;\n};\n\nexports.getChainId = function (provider) {\n  return __awaiter(void 0, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n    return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            return _context3.abrupt(\"return\", chainIdOverride || exports.send(provider, 'eth_chainId'));\n\n          case 1:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, _callee3);\n  }));\n};\n\nexports.call = function (provider, to, data) {\n  return exports.send(provider, 'eth_call', [{\n    to: to,\n    data: data\n  }, 'latest']);\n};","map":{"version":3,"sources":["/home/ellika/Web3/node_modules/eth-permit/dist/rpc.js"],"names":["__awaiter","thisArg","_arguments","P","generator","adopt","value","resolve","Promise","reject","fulfilled","step","next","e","rejected","result","done","then","apply","__rest","s","t","p","Object","prototype","hasOwnProperty","call","indexOf","getOwnPropertySymbols","i","length","propertyIsEnumerable","defineProperty","exports","getChainId","setChainIdOverride","signData","send","randomId","Math","floor","random","provider","method","params","_a","payload","id","callback","err","error","console","_provider","getUncheckedSigner","r","catch","sendAsync","message","splitSignatureToRSV","signature","substring","v","parseInt","signWithEthers","signer","fromAddress","typeData","getAddress","signerAddress","toLowerCase","Error","types","_unused","EIP712Domain","signTypedData","domain","_signTypedData","rawSignature","typeDataString","JSON","stringify","slice","chainIdOverride","to","data"],"mappings":"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","sourcesContent":["\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.call = exports.getChainId = exports.setChainIdOverride = exports.signData = exports.send = void 0;\nconst randomId = () => Math.floor(Math.random() * 10000000000);\nexports.send = (provider, method, params) => new Promise((resolve, reject) => {\n    var _a;\n    const payload = {\n        id: randomId(),\n        method,\n        params,\n    };\n    const callback = (err, result) => {\n        if (err) {\n            reject(err);\n        }\n        else if (result.error) {\n            console.error(result.error);\n            reject(result.error);\n        }\n        else {\n            resolve(result.result);\n        }\n    };\n    const _provider = ((_a = provider.provider) === null || _a === void 0 ? void 0 : _a.provider) || provider.provider || provider;\n    if (_provider.getUncheckedSigner /* ethers provider */) {\n        _provider\n            .send(method, params)\n            .then((r) => resolve(r))\n            .catch((e) => reject(e));\n    }\n    else if (_provider.sendAsync) {\n        _provider.sendAsync(payload, callback);\n    }\n    else {\n        _provider.send(payload, callback).catch((error) => {\n            if (error.message ===\n                \"Hardhat Network doesn't support JSON-RPC params sent as an object\") {\n                _provider\n                    .send(method, params)\n                    .then((r) => resolve(r))\n                    .catch((e) => reject(e));\n            }\n            else {\n                throw error;\n            }\n        });\n    }\n});\nconst splitSignatureToRSV = (signature) => {\n    const r = '0x' + signature.substring(2).substring(0, 64);\n    const s = '0x' + signature.substring(2).substring(64, 128);\n    const v = parseInt(signature.substring(2).substring(128, 130), 16);\n    return { r, s, v };\n};\nconst signWithEthers = (signer, fromAddress, typeData) => __awaiter(void 0, void 0, void 0, function* () {\n    const signerAddress = yield signer.getAddress();\n    if (signerAddress.toLowerCase() !== fromAddress.toLowerCase()) {\n        throw new Error('Signer address does not match requested signing address');\n    }\n    const _a = typeData.types, { EIP712Domain: _unused } = _a, types = __rest(_a, [\"EIP712Domain\"]);\n    const rawSignature = yield (signer.signTypedData\n        ? signer.signTypedData(typeData.domain, types, typeData.message)\n        : signer._signTypedData(typeData.domain, types, typeData.message));\n    return splitSignatureToRSV(rawSignature);\n});\nexports.signData = (provider, fromAddress, typeData) => __awaiter(void 0, void 0, void 0, function* () {\n    if (provider._signTypedData || provider.signTypedData) {\n        return signWithEthers(provider, fromAddress, typeData);\n    }\n    const typeDataString = typeof typeData === 'string' ? typeData : JSON.stringify(typeData);\n    const result = yield exports.send(provider, 'eth_signTypedData_v4', [fromAddress, typeDataString])\n        .catch((error) => {\n        if (error.message === 'Method eth_signTypedData_v4 not supported.') {\n            return exports.send(provider, 'eth_signTypedData', [fromAddress, typeData]);\n        }\n        else {\n            throw error;\n        }\n    });\n    return {\n        r: result.slice(0, 66),\n        s: '0x' + result.slice(66, 130),\n        v: parseInt(result.slice(130, 132), 16),\n    };\n});\nlet chainIdOverride = null;\nexports.setChainIdOverride = (id) => { chainIdOverride = id; };\nexports.getChainId = (provider) => __awaiter(void 0, void 0, void 0, function* () { return chainIdOverride || exports.send(provider, 'eth_chainId'); });\nexports.call = (provider, to, data) => exports.send(provider, 'eth_call', [{\n        to,\n        data,\n    }, 'latest']);\n"]},"metadata":{},"sourceType":"script"}